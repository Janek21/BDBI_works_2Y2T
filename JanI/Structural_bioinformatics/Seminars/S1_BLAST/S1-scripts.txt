##Step1-BLAST
#Look for proteins known structure similar to target
blastp -query TARGET.fa -db ~/Documents/databases/pdb_seq -out TARGET_PDB.out
 	$blastp -query [target.fasta] -db [database] -out [output]


##Step2-PSIBLAST
#Psiblast search into pdb database (5 iterations), pdb is redundant (biased), for non-redundant -> Uniprot
psiblast -query TARGET.fa -db ~/Documents/databases/pdb_seq -num_iterations 5 â€“out TARGET.out
	$psiblast -query [target.fasta] -db [database] -num_iterations [number of iterations] -out [output]

#Psiblast with UniProt to create database(pssm)
psiblast -query TARGET.fa -num_iterations 5 -out_pssm TARGET.pssm -out TARGET.out -db ~/Documents/databases/uniprot_sprot.fasta
	$psiblast -query [target.fasta] -num_iterations [number of iterations] -out_pssm [target.pssm] -out [output] -db [database]
	
#Use the pssm database to search in the PDB, results= prot with known structure
psiblast -db ~/Documents/databases/pdb_seq -in_pssm target_sprot5.pssm -out target_pdb_sprot5.out
	$psiblast -db [database] -in_pssm [target.pssm] -out [output]


##Step3-ClustalW+PSIBLAST
#msa->pssm->PDB search, msa generated by ClustalW
clustalw target.fasta
	$clustalw [target.fasta]
#Use perl script to get fasta seq for a set of PSIBLAST -> seq have to be pasted to file (file.list)
perl ~/Documents/databases/perl_scripts/FetchFasta.pl -i file.list -d ~/Documents/databases/uniprot_sprot.fasta -o file.fasta

#Obtain the sequence alignment, put target sequence+ new sequences, FIRST SEQ is TARGET SEQ
cat target.fa > pssm.fasta
	$cat [target.fasta] > [to_align.fasta]
cat file.fasta >> pssm.fasta
	$cat [target.fasta] >> [to_align.fasta]
clustalw2 pssm.fasta
	$clustalw2 [to_align.fasta]
#Change the format of the alignment into a fasta, .aln is the result of the ClustalW [to_align.aln] which turns into [to_align.fa]
perl ~/Documents/databases/perl_scripts/aconvertMod2.pl -in c -out f <pssm.aln>pssm.fa

#Use this msa as PSIBLAST input using -in_msa
psiblast -in_msa pssm.fa -out target_pdb_specific.out -db ~/Documents/databases/pdb_seq
	$psiblast -in_msa [to_align.fa] -out [output] -db [database]



